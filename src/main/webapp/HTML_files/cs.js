function silentErrorHandler(){return true}window.onerror=silentErrorHandler;ClickStreamService=(function(){return{jsonStringData:"",pubGuidId:"NO_GUID",clickStreamURL:"",clickStreamURLS:["http://dwww251.trcw.us.aexp.com/offerservice3/updatecustvisit/updateCustomerVisit/","https://qwww251.americanexpress.com/offerservice2/updatecustvisit/updateCustomerVisit/","https://www251.americanexpress.com/offerservice/updatecustvisit/updateCustomerVisit/"],jqueryURL:"",jqueryURLS:["https://dstatic.dev.ipc.us.aexp.com/api/axpi/pzn/js/jquery/v1.8.2/jquery.min.js","https://qwww.aexp-static.com/api/axpi/pzn/js/jquery/v1.8.2/jquery.min.js","https://www.aexp-static.com/api/axpi/pzn/js/jquery/v1.8.2/jquery.min.js"],hierarchy:"",pageName:"",pmc:"",products:"",init:function(){this.pubGuidId=this.getCookie("blueboxpublic");if(this.pubGuidId!="NO_GUID"){this.pageName=(typeof window.omn_pagename!=="undefined")?window.omn_pagename:"";this.hierarchy=(typeof window.omn_hierarchy!=="undefined")?window.omn_hierarchy:"";this.products=(typeof window.omn_products!=="undefined")?window.omn_products:"";this.pmc=(typeof window.omn_pmc!=="undefined")?window.omn_pmc:"";this.setEnvVariables();jsonData={publicGuid:this.pubGuidId,hierarchy:this.hierarchy,pagename:this.pageName,pmc:this.pmc,products:this.products};this.jsonStringData=this.stringify(jsonData);this.submitRequest()}},submitRequest:function(){if(typeof $!=="undefined"){this.callBackFn(this.clickStreamURL,this.jsonStringData)}else{var b=this.clickStreamURL;var c=this.jsonStringData;var a=this.callBackFn;element=document.createElement("script");element.src=this.jqueryURL;element.setAttribute("type","text/javascript");if(typeof element.onreadystatechange=="undefined"){element.onload=function(){a(b,c)}}else{element.onreadystatechange=function(){var d=false;if((this.readyState=="complete"||this.readyState=="loaded")&&!d){d=true;a(b,c)}}}document.getElementsByTagName("head")[0].appendChild(element)}},callBackFn:function(b,c){if(window.XDomainRequest){var a=new XDomainRequest();a.open("POST",b);a.onload=function(){};a.onerror=function(){};a.onprogress=function(){};a.send("requestData="+c)}else{jQuery.support.cors=true;var d=$.ajax({type:"POST",url:b,crossDomain:true,data:{requestData:c}})}},getCookie:function(b){var a=document.cookie.split(";");var d="";var f="";var e="NO_GUID";for(var c=0;c<a.length;c++){d=a[c].split("=");f=d[0].replace(/^\s+|\s+$/g,"");if(f==b){if(d.length>1){e=unescape(d[1].replace(/^\s+|\s+$/g,""))}return e}d=null;f=""}return e},setEnvVariables:function(){var a=window.location.href;if(a.indexOf(".com:")>-1){a=a.substring(a.indexOf("://")+3,a.indexOf(".com:")+9)}else{a=a.substring(a.indexOf("://")+3,a.indexOf(".com/")+4)}if(!((a.substr(0,1)=="q")||(a.substr(0,2)=="e2")||(a.substr(0,2)=="e1"))&&(a.indexOf(".americanexpress")>-1)){this.clickStreamURL=this.clickStreamURLS[2];this.jqueryURL=this.jqueryURLS[2]}else{if((a.indexOf(".aexp")>-1)){this.clickStreamURL=this.clickStreamURLS[0];this.jqueryURL=this.jqueryURLS[0]}else{this.clickStreamURL=this.clickStreamURLS[1];this.jqueryURL=this.jqueryURLS[1]}}},stringify:(function(){var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,a,e={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},d;function c(i){h.lastIndex=0;return h.test(i)?'"'+i.replace(h,function(j){var k=e[j];return typeof k==="string"?k:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+i+'"'}function f(r,o){var m,l,s,j,p=g,n,q=o[r];if(q&&typeof q==="object"&&typeof q.toJSON==="function"){q=q.toJSON(r)}if(typeof d==="function"){q=d.call(o,r,q)}switch(typeof q){case"string":return c(q);case"number":return isFinite(q)?String(q):"null";case"boolean":case"null":return String(q);case"object":if(!q){return"null"}g+=a;n=[];if(Object.prototype.toString.apply(q)==="[object Array]"){j=q.length;for(m=0;m<j;m+=1){n[m]=f(m,q)||"null"}s=n.length===0?"[]":g?"[\n"+g+n.join(",\n"+g)+"\n"+p+"]":"["+n.join(",")+"]";g=p;return s}if(d&&typeof d==="object"){j=d.length;for(m=0;m<j;m+=1){if(typeof d[m]==="string"){l=d[m];s=f(l,q);if(s){n.push(c(l)+(g?": ":":")+s)}}}}else{for(l in q){if(Object.prototype.hasOwnProperty.call(q,l)){s=f(l,q);if(s){n.push(c(l)+(g?": ":":")+s)}}}}s=n.length===0?"{}":g?"{\n"+g+n.join(",\n"+g)+"\n"+p+"}":"{"+n.join(",")+"}";g=p;return s}}return function(m,k,l){if(typeof JSON!=="undefined"&&typeof JSON.stringify!=="undefined"){return JSON.stringify(m,k,l)}var j;g="";a="";if(typeof l==="number"){for(j=0;j<l;j+=1){a+=" "}}else{if(typeof l==="string"){a=l}}d=k;if(k&&typeof k!=="function"&&(typeof k!=="object"||typeof k.length!=="number")){throw new Error("JSON.stringify")}return f("",{"":m})}})()}})();ClickStreamService.init();